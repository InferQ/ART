<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART Framework Documentation</title>
    <!-- Marked for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    
    <style>
        :root {
            --sidebar-width: 300px;
            --primary-color: #2563eb;
            --text-color: #334155;
            --bg-color: #ffffff;
            --sidebar-bg: #f8fafc;
            --border-color: #e2e8f0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            display: flex;
            min-height: 100vh;
            color: var(--text-color);
        }

        /* Sidebar */
        #sidebar {
            width: var(--sidebar-width);
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 2rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-sizing: border-box;
        }

        #sidebar h2 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            color: #0f172a;
        }

        .nav-group {
            margin-bottom: 2rem;
        }

        .nav-group-title {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            color: #64748b;
            margin-bottom: 0.75rem;
        }

        .nav-link {
            display: block;
            padding: 0.5rem 0;
            color: #475569;
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .nav-link.active {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Main Content */
        #main {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 3rem 4rem;
            max-width: 900px;
        }

        /* Markdown Styles */
        .markdown-body {
            line-height: 1.6;
        }

        .markdown-body h1 { font-size: 2.25rem; margin-bottom: 1.5rem; color: #0f172a; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .markdown-body h2 { font-size: 1.75rem; margin-top: 2.5rem; margin-bottom: 1rem; color: #0f172a; }
        .markdown-body h3 { font-size: 1.5rem; margin-top: 2rem; margin-bottom: 0.75rem; color: #1e293b; }
        
        .markdown-body code {
            background-color: #f1f5f9;
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.9em;
        }

        .markdown-body pre code {
            background-color: transparent;
            padding: 0;
            font-size: 0.9em;
        }

        .markdown-body pre {
            background-color: #0d1117; /* GitHub Dark bg */
            padding: 1.25rem;
            border-radius: 8px;
            overflow-x: auto;
            color: #c9d1d9;
        }

        .markdown-body a { color: var(--primary-color); text-decoration: none; }
        .markdown-body a:hover { text-decoration: underline; }
        
        .markdown-body blockquote {
            border-left: 4px solid var(--border-color);
            margin: 0;
            padding-left: 1rem;
            color: #64748b;
        }

        .markdown-body table {
            border-collapse: collapse;
            width: 100%;
            margin: 1.5rem 0;
        }
        
        .markdown-body th, .markdown-body td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }

        .markdown-body th {
            background-color: #f8fafc;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            #sidebar { display: none; } /* Simplified mobile view (not fully implemented) */
            #main { margin-left: 0; padding: 1.5rem; }
        }
    </style>
</head>
<body>

    <nav id="sidebar">
        <h2>ART Framework</h2>
        
        <div class="nav-group">
            <div class="nav-group-title">Overview</div>
            <a href="#art-framework-api-guide.md" class="nav-link" data-path="art-framework-api-guide.md">Introduction & API</a>
            <a href="#learnings.md" class="nav-link" data-path="learnings.md">Learnings</a>
        </div>

        <div class="nav-group">
            <div class="nav-group-title">Concepts</div>
            <a href="#concepts/pes-agent.md" class="nav-link" data-path="concepts/pes-agent.md">PES Agent</a>
            <a href="#concepts/state-management.md" class="nav-link" data-path="concepts/state-management.md">State Management</a>
            <a href="#concepts/ui-system.md" class="nav-link" data-path="concepts/ui-system.md">UI System</a>
            <a href="#concepts/mcp-system.md" class="nav-link" data-path="concepts/mcp-system.md">MCP System</a>
            <a href="#concepts/observations.md" class="nav-link" data-path="concepts/observations.md">Observations</a>
        </div>

        <div class="nav-group">
            <div class="nav-group-title">How-To Guides</div>
            <a href="#how-to/connecting-your-ui.md" class="nav-link" data-path="how-to/connecting-your-ui.md">Connecting Your UI</a>
            <a href="#how-to/creating-and-switching-agents.md" class="nav-link" data-path="how-to/creating-and-switching-agents.md">Agents & Switching</a>
            <a href="#how-to/customizing-agent-persona.md" class="nav-link" data-path="how-to/customizing-agent-persona.md">Customizing Persona</a>
            <a href="#how-to/streaming-Gemini-Thoughts-to-the-UI.md" class="nav-link" data-path="how-to/streaming-Gemini-Thoughts-to-the-UI.md">Streaming Gemini Thoughts</a>
            <a href="#how-to/supabase-persistence.md" class="nav-link" data-path="how-to/supabase-persistence.md">Supabase Persistence</a>
            <a href="#how-to/creating-custom-provider-adapter.md" class="nav-link" data-path="how-to/creating-custom-provider-adapter.md">Custom Provider Adapter</a>
        </div>

        <div class="nav-group">
            <div class="nav-group-title">Reference</div>
            <a href="components/index.html" target="_blank" class="nav-link">API Reference â†—</a>
        </div>
    </nav>

    <main id="main">
        <div id="content" class="markdown-body">
            <!-- Content will be injected here -->
            <p>Loading...</p>
        </div>
    </main>

    <script>
        const contentDiv = document.getElementById('content');
        const defaultPage = 'art-framework-api-guide.md';

        // Initialize Marked
        marked.setOptions({
            highlight: function(code, lang) {
                const language = highlight.js.getLanguage(lang) ? lang : 'plaintext';
                return highlight.js.highlight(code, { language }).value;
            },
            langPrefix: 'hljs language-'
        });

        async function loadPage(path) {
            try {
                // Fetch markdown content
                const response = await fetch(path);
                if (!response.ok) {
                    throw new Error(`Failed to load page: ${response.statusText}`);
                }
                const text = await response.text();

                // Convert to HTML
                const html = marked.parse(text);
                contentDiv.innerHTML = html;

                // Trigger Highlight.js (if not handled by marked options)
                hljs.highlightAll();

                // Scroll to top
                window.scrollTo(0, 0);

                // Update active sidebar link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.path === path) {
                        link.classList.add('active');
                    }
                });

            } catch (error) {
                contentDiv.innerHTML = `<h1>Error</h1><p>${error.message}</p><p>Make sure you are serving this folder via a web server.</p>`;
            }
        }

        function handleRoute() {
            let hash = window.location.hash.slice(1); // Remove '#'
            if (!hash) {
                hash = defaultPage;
            }
            loadPage(hash);
        }

        // Listen for hash changes
        window.addEventListener('hashchange', handleRoute);

        // Initial load
        handleRoute();
    </script>
</body>
</html>